# Статус проекта Components Aggregator

## Текущая архитектура
- Основной сервер (агрегатор) работает на удаленном сервере (89.104.69.77)
- Прокси-сервер работает локально (порт 8002) для обхода ограничений ChipDip
- Используется прямое соединение между серверами
- Реализована система парсеров с фолбэком

## Что уже работает
1. ✅ Прокси-сервер успешно парсит ChipDip (проверено на LM317 - найдено 21 товаров)
2. ✅ Настроена схема БД с кэшированием
3. ✅ Реализован базовый поиск
4. ✅ Добавлен микро-чип прелоадер
5. ✅ **НОВОЕ**: Реализован GET /api/search с пагинацией и нормализацией данных
6. ✅ **НОВОЕ**: Создана система парсеров для фолбэка (LCSC, TME, Farnell, JLCPCB, Future, OEMSTrade)
7. ✅ **НОВОЕ**: Реализована нормализация данных в канон Product
8. ✅ **НОВОЕ**: Добавлена логика фолбэка: ChipDip первично, если мало результатов - парсеры

## API поиска
- **Эндпоинт**: `GET /api/search?q={query}&page={page}&pageSize={pageSize}`
- **Ответ**: `{items: Product[], total: number, page: number, pageSize: number, hasMore: boolean}`
- **Канон Product**: mpn, description, availability{inStock,lead}, pricing[{qty,price,currency}], package, packaging, url, suppliers[]
- **Фолбэк**: Если ChipDip возвращает < 5 товаров, автоматически запрашиваются парсеры

## Текущие проблемы
1. Основной сервер не может подключиться к локальному прокси
2. Поиск некоторых товаров не работает (LDD-350L, LDD-700L)
3. Парсеры фолбэка требуют настройки селекторов для реальных сайтов

## Следующие шаги
1. Открыть порт 8002 в Windows Defender
2. Настроить прямое соединение между серверами
3. Если прямое соединение не заработает - настроить SSH туннель
4. Протестировать поиск случайных товаров
5. Исправить ошибки поиска
6. Настроить селекторы парсеров для реальных сайтов
7. Добавить обработку ошибок парсеров

## Технические детали
- Прокси: http://localhost:8002 (локальный)
- Основной сервер: http://89.104.69.77
- БД: SQLite (cache.db)
- Зависимости: Node.js, Express, Axios, Cheerio
- Парсеры: parsers/ (LCSC, TME, Farnell, JLCPCB, Future, OEMSTrade)

## Важные заметки
1. Не менять архитектуру - используем локальный компьютер как прокси
2. Приоритет - стабильная работа поиска
3. Тестировать на реальных товарах, не из кэша
4. Сохранять все логи для отладки
5. **НОВОЕ**: API поиска готов к использованию фронтендом
